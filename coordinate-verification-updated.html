<!DOCTYPE html>
<html>
<head>
    <title>Venue Coordinate Verification</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .tournament { margin-bottom: 30px; padding: 15px; border: 1px solid #ccc; }
        .coords { background: #f0f0f0; padding: 10px; margin: 10px 0; }
        .address { font-weight: bold; color: #0066cc; margin-bottom: 10px; }
        .link { color: #0066cc; text-decoration: none; margin-right: 15px; }
        .link:hover { text-decoration: underline; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .pending { background: #fff3cd; border: 1px solid #ffeaa7; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        button { background: #0066cc; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0052a3; }
    </style>
</head>
<body>
    <h1>Venue Coordinate Verification</h1>
    
    <div class="status pending">
        <strong>Status:</strong> Ready to fix coordinates using exact venue addresses
    </div>
    
    <button onclick="fixCoordinates()">Fix Coordinates from Exact Addresses</button>
    <div id="results"></div>
    
    <h2>Expected Addresses to Geocode:</h2>
    
    <div class="tournament">
        <h3>Madrid Tournament</h3>
        <div class="address">
            <strong>Exact Address String:</strong><br>
            "Cam. de Cubas, 16, 28991 Torrej√≥n de la Calzada, Madrid, 28991, Mostoles, ES"
        </div>
        <a href="https://www.google.com/maps/search/Cam.+de+Cubas,+16,+28991+Torrej√≥n+de+la+Calzada,+Madrid" target="_blank" class="link">
            üó∫Ô∏è Google Maps Search
        </a>
        <a href="https://www.google.com/maps/search/Cam.+de+Cubas,+16,+Torrej√≥n+de+la+Calzada,+Madrid,+Spain" target="_blank" class="link">
            üåç Alternative Search
        </a>
    </div>
    
    <div class="tournament">
        <h3>Austria Tournament</h3>
        <div class="address">
            <strong>Exact Address String:</strong><br>
            "Sportzentrum Neustift im M√ºhlkreis, Upper Austria, 4143, Austria, AT"
        </div>
        <a href="https://www.google.com/maps/search/Sportzentrum+Neustift+im+M√ºhlkreis,+4143,+Austria" target="_blank" class="link">
            üó∫Ô∏è Google Maps Search
        </a>
        <a href="https://www.google.com/maps/search/Sportzentrum+Neustift+im+M√ºhlkreis,+Upper+Austria" target="_blank" class="link">
            üåç Alternative Search
        </a>
    </div>
    
    <h3>Verification Steps:</h3>
    <ol>
        <li><strong>Click "Fix Coordinates"</strong> - This will geocode the exact address strings and update the database</li>
        <li><strong>Check Google Maps links</strong> - Verify the addresses point to the actual venues</li>
        <li><strong>Compare with site map</strong> - Our pins should match Google's results exactly</li>
        <li><strong>Test homepage map</strong> - Reload the site and verify pins are at correct venues</li>
    </ol>

    <script>
        async function fixCoordinates() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="status pending">Processing venue coordinates from exact addresses...</div>';

            try {
                const response = await fetch('https://yknmcddrfkggphrktivd.supabase.co/functions/v1/fix-venue-coordinates', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();
                
                if (data.success) {
                    let html = '<div class="status success"><strong>‚úÖ Coordinates Fixed Successfully!</strong></div>';
                    html += '<h3>Results:</h3>';
                    
                    data.results.forEach(r => {
                        html += `
                            <div class="tournament">
                                <h4>${r.name}</h4>
                                <div class="address"><strong>Address Used:</strong> ${r.address}</div>
                                ${r.error ? 
                                    `<div style="color: red;">‚ùå Error: ${r.error}</div>` :
                                    `<div class="coords">
                                        <strong>New Coordinates:</strong> ${r.latitude}, ${r.longitude}<br>
                                        ${r.old_latitude ? `<em>Previous:</em> ${r.old_latitude}, ${r.old_longitude}` : ''}
                                    </div>
                                    <a href="https://www.google.com/maps/@${r.latitude},${r.longitude},17z" target="_blank" class="link">
                                        üìç View New Pin Location
                                    </a>`
                                }
                            </div>
                        `;
                    });
                    
                    html += `
                        <div class="status success">
                            <strong>Next Steps:</strong><br>
                            1. Click the "View New Pin Location" links above to verify coordinates<br>
                            2. Reload your website's homepage to see the updated pin positions<br>
                            3. Compare with Google Maps searches to confirm exact venue matches
                        </div>
                    `;
                    
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = `<div class="status" style="background: #f8d7da; border: 1px solid #f5c6cb;">‚ùå Error: ${data.error}</div>`;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status" style="background: #f8d7da; border: 1px solid #f5c6cb;">‚ùå Error: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>